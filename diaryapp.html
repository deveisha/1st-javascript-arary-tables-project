<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dairyapp</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
      integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous"
    />
    <script
      src="https://code.jquery.com/jquery-3.3.1.min.js"
      integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
      crossorigin="anonymous"
    ></script>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
      integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
      crossorigin="anonymous"
    ></script>
  </head>
  <body
    style="
      background: #e5e5e5;
      height: 100vh;
      margin: 0 50px;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
    "
  >
    <div
      class="myApp"
      style="
        background: #fff;
        width: 450px;
        height: 650px;
        border: 4px solid #727a727f;
        border-radius: 8px;
        padding: 10px;
      "
    >
      <h4 class="mt-3 text-center fa-2x">Diary app</h4>
      <br />
      <div
        data-toggle="modal"
        data-target="#exampleModal"
        class="bg-secondary d-flex justify-content-between align-items-center"
        id="add"
        style="color:'white'  border-radius: 10px;  padding:5px 10px">
        <span class="m-3 fa-1x">Add New Task </span>
        <i class="fa-solid fa-plus bg-secondary p-3px m-3 border-radius-3"></i>
      </div>
      <h5 class="text-center my-5 fa-2x">Tasks</h5>
      <div id="tasks">
        <!-- Div from Dynamic way -->
      </div>
    </div>

    <!-- form -->
    <div
      class="modal fade"
      id="exampleModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">
              Create a Notebook
            </h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form>
              <div class="form-group">
                <label for="recipient-name" class="col-form-label"
                  >Task Title:</label
                >
                <input type="text" class="form-control" id="titleInput" />
                <div style="color: red" id="msg"></div>
              </div>
              <div class="form-group">
                <label for="recipient-name" class="col-form-label"
                  >Due Date:</label
                >
                <input type="date" class="form-control" id="dateInput" />
              </div>
              <div class="form-group">
                <label for="message-text" class="col-form-label"
                  >Description:</label
                >
                <textarea
                  class="form-control"
                  cols="20"
                  rows="5"
                  id="textareaInput"
                ></textarea>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-dismiss="modal"
            >
              Close
            </button>
            <button
              type="button"
              class="btn btn-primary"
              onclick="validateFunc()"
            >
              Submit
            </button>
          </div>
        </div>
      </div>
    </div>
    <script style="background-color: blue;">
      let form = document.getElementById("exampleModal");
      let textarea = document.getElementById("textareaInput");
      let dateInput = document.getElementById("dateInput");
      let title = document.getElementById("titleInput");
      let tasks = document.getElementById("tasks");
      let add = document.getElementById("add");
      let msg = document.getElementById("msg");

      let store = [];
      let resetForm = () => {
        title.value = " ";
        dateInput.value = " ";
        textarea.value = " ";
      };
      let createTasks = () => {
        tasks.innerHTML = "  ";

        store.map((item, ind) => {
          return (tasks.innerHTML += `<div id=${ind}>
       <span class="fw-bold"> ${item.text}</span>
       <span class="small text-secondary"> ${item.date}</span>
       <span> ${item.description}</span>
      <span>
        <i class="fa-solid fa-pen-to-square fa-lg"style="margin-left:60%;" onclick="editTask(this)" ></i>
        <i class="fa-solid fa-trash-alt fa-lg" onclick="deleteTask(this), createTask()"></i>
        </span>
      </div>`);
        });
        store = JSON.parse(localStorage.getItem("store")) || [];
        resetForm();
      };

      let validateFunc = () => {
        if (title.value === "") {
          console.log("failure....");
          msg.innerHTML = "Task cannot be empty.";
        } else {
          console.log("success....");
          acceptData();
          msg.innerHTML = "";
        }
      };

      let acceptData = () => {
        store.push({
          text: title.value,
          date: dateInput.value,
          description: textarea.value,
        });

        //localStorage in js
        localStorage.setItem("store", JSON.stringify(store));
        console.log(store);
        createTasks();
      };

      const deleteTask = (item) => {
        item.parentElement.parentElement.remove();
        store.splice(item.parentElement.parentElement.id, 1);

        console.log(
          "value deleted",
          store.splice(item.parentElement.parentElement.id, 1)
        );
      };

      let editTask = (val) => {
        let selectedTask = val.parentElement.parentElement;

        title.value = selectedTask.children[0].innerHTML;
        dateInput.value = selectedTask.children[1].innerHTML;
        textarea.value = selectedTask.children[2].innerHTML;

        // deleteTask(val);
      };
    </script>
  </body>
</html>